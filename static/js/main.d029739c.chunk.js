(this["webpackJsonpreact-minesweeper"]=this["webpackJsonpreact-minesweeper"]||[]).push([[0],{16:function(e,t,s){},17:function(e,t,s){},18:function(e,t,s){"use strict";s.r(t);var a,i=s(0),n=s(1),r=s.n(n),o=s(6),c=s.n(o),l=(s(16),s(2)),d=s(3),h=s(10),b=s(9),u=s(7),m=s(8),j=-1;!function(e){e.NotStarted="Game not started",e.Started="Game started",e.Lost="Game lost",e.Won="Game won"}(a||(a={}));var v,f=function(){function e(t){var s=t.rows,i=t.columns,n=t.mines;Object(u.a)(this,e),this.state=a.NotStarted,this.board=[],this.mines=0,this.rows=0,this.columns=0,this.maxCol=0,this.maxRow=0,this.nearbyHidden=0,this.rows=s,this.columns=i,this.maxCol=i-1,this.maxRow=s-1,this.mines=this.getMaximumNumberOfMines({rows:s,columns:i,mines:n})}return Object(m.a)(e,[{key:"check",value:function(e){var t=Object(l.a)(e,2),s=t[0],i=t[1];switch(this.state){case a.Lost:case a.Won:break;case a.NotStarted:this.distribute(e),this.state=a.Started,this.openCells(e);break;default:if(void 0!==this.board[s]&&this.board[s][i]===j)return this.state=a.Lost,this.state;this.openCells(e)}return this.state}},{key:"getMaximumNumberOfMines",value:function(e){var t=e.rows,s=e.columns,a=e.mines,i=(t-1)*(s-1);return Math.min(i,a)}},{key:"openCells",value:function(e){for(var t,s,i=Object(l.a)(e,2),n=[i[0],i[1]];n.length>1;)if(s=n.pop(),t=n.pop(),void 0===this.board[t]&&(this.board[t]=[]),this.board[t][s]<j){if(this.board[t][s]=-1*this.board[t][s]-1,this.nearbyHidden--,0===this.nearbyHidden)return void(this.state=a.Won)}else void 0===this.board[t][s]&&(this.board[t][s]=0,t-1>=0&&(void 0===this.board[t-1]||void 0===this.board[t-1][s]||this.board[t-1][s]<j)&&n.push(t-1,s),t+1<=this.maxRow&&(void 0===this.board[t+1]||void 0===this.board[t+1][s]||this.board[t+1][s]<j)&&n.push(t+1,s),s-1>=0&&(void 0===this.board[t]||void 0===this.board[t][s-1]||this.board[t][s-1]<j)&&n.push(t,s-1),s+1<=this.maxCol&&(void 0===this.board[t]||void 0===this.board[t][s+1]||this.board[t][s+1]<j)&&n.push(t,s+1))}},{key:"distribute",value:function(e){this.distributeMines(e)}},{key:"distributeEmptyCells",value:function(e){throw new Error("Not implemented")}},{key:"distributeMines",value:function(e){for(var t,s,a=Object(l.a)(e,2),i=a[0],n=a[1],r=this.mines;r>0;)t=Math.floor(Math.random()*this.maxRow),s=Math.floor(Math.random()*this.maxCol),t===i&&s===n||void 0!==this.board[t]&&this.board[t][s]===j||(void 0===this.board[t]&&(this.board[t]=[]),this.board[t][s]<j&&this.nearbyHidden--,this.board[t][s]=j,this.initNearbyCells([t,s]),r--)}},{key:"initNearbyCells",value:function(e){for(var t=Object(l.a)(e,2),s=t[0],a=t[1],i=s-1;i<s+2;i++)for(var n=a-1;n<a+2;n++)if(!(i===s&&n===a||i<0||n<0||i>this.maxRow||n>this.maxCol))switch(void 0===this.board[i]&&(this.board[i]=[]),this.board[i][n]){case j:break;case void 0:this.board[i][n]=-2,this.nearbyHidden++;break;default:this.board[i][n]-=1}}}]),e}();function O(e,t){var s=t.type,a=t.payload;switch(s){case v.SetParams:return Object(d.a)(Object(d.a)({},e),{},{params:a,minesweeper:new f(a)});case v.Check:return e.minesweeper.check(a),Object(d.a)({},e);default:return e}}!function(e){e.SetParams="SET_PARAMS",e.Check="CHECK"}(v||(v={}));var x=Object(n.createContext)({state:{},dispatch:function(){return null}}),p={width:50,height:50};var w=function(e){var t=e.rowIndex,s=e.columnIndex,r=e.style,o=e.onClick,c=e.onContextMenu,l=e.flag,d=void 0!==l&&l,h=Object(n.useContext)(x).state.minesweeper,b=h.board[t]&&h.board[t][s],u=b;if(h.state===a.Lost||h.state===a.Won)switch(b){case j:u="\ud83d\udca3";break;case 0:case void 0:u=void 0;break;default:b<j&&(u=-1*b-1)}else d&&(b<0||void 0===b)?u="\ud83d\udea9":(b<=j||0===b)&&(u=void 0);return Object(i.jsx)("div",{className:"cell",style:r,children:Object(i.jsx)("button",{"data-row":t,"data-column":s,style:p,className:"button",onClick:o,onContextMenu:c,disabled:0===b||b>0||h.state===a.Lost||h.state===a.Won,children:u})})};function N(e){return[parseInt(e.dataset.row,10),parseInt(e.dataset.column,10)]}var y=0;var C=function(){var e=Object(b.a)(),t=e.ref,s=e.width,a=e.height,r=Object(n.useState)({}),o=Object(l.a)(r,2),c=o[0],u=o[1],m=Object(n.useContext)(x),j=m.state,f=j.params,O=j.minesweeper,p=m.dispatch;Object(n.useEffect)((function(){u({}),y=0}),[O]);var C=function(e){var t=N(e.target),s=Object(l.a)(t,2),a=s[0],i=s[1];c[a]&&c[a][i]||p({type:v.Check,payload:[a,i]})},g=function(e){if("contextmenu"===e.type){if(e.preventDefault(),y===f.mines)return;var t=Object(d.a)({},c),s=N(e.target),a=Object(l.a)(s,2),i=a[0],n=a[1];t[i]||(t[i]={}),t[i][n]=!t[i][n],u(t),y++}};return Object(i.jsx)("div",{ref:t,className:"container",style:{minHeight:300,height:"100%"},children:s&&a&&Object(i.jsx)(h.a,{columnCount:f.columns,rowCount:f.rows,columnWidth:50,rowHeight:50,width:s,height:a,children:function(e){return Object(i.jsx)(w,Object(d.a)(Object(d.a)({},e),{},{flag:c[e.rowIndex]&&c[e.rowIndex][e.columnIndex],onClick:C,onContextMenu:g}))}})})},g=s(4);var k=function(e){var t=parseInt(e,10);return!t||t<0?0:t};var M=function(){var e,t=Object(n.useContext)(x),s=t.state,r=t.dispatch,o=Object(n.useState)(s.params),c=Object(l.a)(o,2),h=c[0],b=c[1],u=function(e){var t=e.target,s=t.id,a=t.value;b(Object(d.a)(Object(d.a)({},h),{},Object(g.a)({},s,k(a))))},m=Object.values(h).every((function(e){return e}));switch(s.minesweeper.state){case a.Lost:e="\ud83d\ude35";break;case a.Won:e="\ud83d\ude0e";break;default:e="\ud83d\ude00"}return Object(i.jsxs)("form",{className:"container pb-3",onSubmit:function(e){e.preventDefault(),m&&r({type:v.SetParams,payload:h})},children:[Object(i.jsxs)("div",{className:"columns",children:[Object(i.jsx)("div",{className:"column",children:Object(i.jsxs)("div",{className:"field",children:[Object(i.jsx)("label",{className:"label",htmlFor:"rows",children:"Rows"}),Object(i.jsx)("div",{className:"control",children:Object(i.jsx)("input",{id:"rows",name:"rows",type:"number",className:"input",autoComplete:"off",value:null===h||void 0===h?void 0:h.rows.toString(),onChange:u})})]})}),Object(i.jsx)("div",{className:"column",children:Object(i.jsxs)("div",{className:"field",children:[Object(i.jsx)("label",{className:"label",htmlFor:"columns",children:"Columns"}),Object(i.jsx)("div",{className:"control",children:Object(i.jsx)("input",{id:"columns",name:"columns",className:"input",autoComplete:"off",type:"number",value:null===h||void 0===h?void 0:h.columns.toString(),onChange:u})})]})}),Object(i.jsx)("div",{className:"column",children:Object(i.jsxs)("div",{className:"field",children:[Object(i.jsx)("label",{className:"label",htmlFor:"mines",children:"Mines"}),Object(i.jsx)("div",{className:"control",children:Object(i.jsx)("input",{id:"mines",name:"mines",className:"input",autoComplete:"off",type:"number",value:null===h||void 0===h?void 0:h.mines.toString(),onChange:u})})]})})]}),Object(i.jsx)("div",{className:"has-text-centered",children:Object(i.jsx)("button",{className:"button is-primary is-large",disabled:!m,type:"submit",children:e})})]})},S=(s(17),{rows:1e3,columns:1e3,mines:2e4}),I={params:S,minesweeper:new f(S)};var H=function(){var e=Object(n.useReducer)(O,I),t=Object(l.a)(e,2),s=t[0],a=t[1];return Object(i.jsx)(x.Provider,{value:{state:s,dispatch:a},children:Object(i.jsxs)("div",{className:"is-flex is-flex-direction-column game",children:[Object(i.jsx)("section",{className:"hero",children:Object(i.jsx)("div",{className:"hero-body",children:Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)("h1",{className:"title",children:"Minesweeper Game"}),Object(i.jsx)("h2",{className:"subtitle",children:Object(i.jsx)("a",{href:"https://github.com/dn-l/react-minesweeper",children:"github.com/dn-l/react-minesweeper"})})]})})}),Object(i.jsx)("section",{children:Object(i.jsx)(M,{})}),Object(i.jsx)("section",{className:"pb-5",style:{flex:1},children:Object(i.jsx)(C,{})})]})})};var R=function(){return Object(i.jsx)(H,{})};c.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(R,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.d029739c.chunk.js.map