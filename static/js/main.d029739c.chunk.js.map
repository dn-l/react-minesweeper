{"version":3,"sources":["lib/Minesweeper.ts","components/GameContext.ts","components/Cell.tsx","components/Board.tsx","utils/parsePositiveNumber.ts","components/GameSetup.tsx","components/Game.tsx","App.tsx","index.tsx"],"names":["GameState","MINE","ActionType","Minesweeper","rows","columns","mines","state","NotStarted","board","maxCol","maxRow","nearbyHidden","this","getMaximumNumberOfMines","start","row","column","Lost","Won","distribute","Started","openCells","undefined","maxMines","Math","min","i","j","queue","length","pop","push","distributeMines","Error","mineRow","mineColumn","minesLeft","floor","random","initNearbyCells","reducer","type","payload","SetParams","params","minesweeper","Check","check","GameContext","createContext","dispatch","CELL_STYLE","width","height","Cell","rowIndex","columnIndex","style","onClick","onContextMenu","flag","useContext","val","body","className","data-row","data-column","disabled","getCoordinates","target","parseInt","dataset","numberOfFlags","Board","useResizeObserver","ref","useState","flags","setFlags","useEffect","handleClick","e","handleContextMenu","preventDefault","newFlags","minHeight","columnCount","rowCount","columnWidth","rowHeight","props","parsePositiveNumber","input","result","GameSetup","startButtonBody","formData","setFormData","handleChange","id","value","formIsValid","Object","values","every","onSubmit","htmlFor","name","autoComplete","toString","onChange","initialParams","initialState","Game","useReducer","Provider","href","flex","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d029739c.chunk.js","sourcesContent":["export interface GameParameters {\n  rows: number;\n  columns: number;\n  mines: number;\n}\n\nexport type CellCoordinates = number[];\n\nexport const MINE = -1;\nexport const OPENED = 0;\n\nexport enum GameState {\n  NotStarted = \"Game not started\",\n  Started = \"Game started\",\n  Lost = \"Game lost\",\n  Won = \"Game won\",\n}\n\n// Possible values (numbers) that could be placed on the board:\n// -1 is a mine\n// 0 is an open cell\n// everything lower than -1 is a hint of nearby mine, example:\n//   -3 shows that there're 2 mines nearby\n//   -2 shows that there's 1 mine nearby\n// positive numbers show that the hint cell is opened, example:\n//    2 shows that there's 2 mines nearby\n\nclass Minesweeper {\n  state: GameState = GameState.NotStarted;\n  board: number[][] = [];\n  private mines: number = 0;\n  private rows: number = 0;\n  private columns: number = 0;\n  private maxCol: number = 0;\n  private maxRow: number = 0;\n  private nearbyHidden: number = 0;\n\n  constructor({ rows, columns, mines }: GameParameters) {\n    this.rows = rows;\n    this.columns = columns;\n    this.maxCol = columns - 1;\n    this.maxRow = rows - 1;\n    this.mines = this.getMaximumNumberOfMines({ rows, columns, mines });\n  }\n\n  check(start: CellCoordinates): GameState {\n    const [row, column] = start;\n\n    switch (this.state) {\n      case GameState.Lost:\n      case GameState.Won:\n        break;\n\n      case GameState.NotStarted:\n        this.distribute(start);\n        this.state = GameState.Started;\n        this.openCells(start);\n        break;\n\n      default:\n        if (this.board[row] !== undefined && this.board[row][column] === MINE) {\n          this.state = GameState.Lost;\n          return this.state;\n        }\n        this.openCells(start);\n        break;\n    }\n    return this.state;\n  }\n\n  // http://www.minesweeper.info/custom.php\n  // The maximum number of mines is determined by ( x-1 )( y-1 )\n  private getMaximumNumberOfMines({ rows, columns, mines }: GameParameters) {\n    const maxMines = (rows - 1) * (columns - 1);\n    return Math.min(maxMines, mines);\n  }\n\n  private openCells([row, column]: CellCoordinates) {\n    const queue: number[] = [row, column];\n\n    let i: number;\n    let j: number;\n    while (queue.length > 1) {\n      j = queue.pop() as number;\n      i = queue.pop() as number;\n\n      if (this.board[i] === undefined) {\n        this.board[i] = [];\n      }\n\n      if (this.board[i][j] < MINE) {\n        this.board[i][j] = this.board[i][j] * -1 - 1;\n        this.nearbyHidden--;\n        if (this.nearbyHidden === 0) {\n          this.state = GameState.Won;\n          return;\n        }\n        continue;\n      }\n\n      if (this.board[i][j] === undefined) {\n        this.board[i][j] = 0;\n        if (\n          i - 1 >= 0 &&\n          (this.board[i - 1] === undefined ||\n            this.board[i - 1][j] === undefined ||\n            this.board[i - 1][j] < MINE)\n        ) {\n          queue.push(i - 1, j);\n        }\n        if (\n          i + 1 <= this.maxRow &&\n          (this.board[i + 1] === undefined ||\n            this.board[i + 1][j] === undefined ||\n            this.board[i + 1][j] < MINE)\n        ) {\n          queue.push(i + 1, j);\n        }\n        if (\n          j - 1 >= 0 &&\n          (this.board[i] === undefined ||\n            this.board[i][j - 1] === undefined ||\n            this.board[i][j - 1] < MINE)\n        ) {\n          queue.push(i, j - 1);\n        }\n        if (\n          j + 1 <= this.maxCol &&\n          (this.board[i] === undefined ||\n            this.board[i][j + 1] === undefined ||\n            this.board[i][j + 1] < MINE)\n        ) {\n          queue.push(i, j + 1);\n        }\n      }\n    }\n  }\n\n  private distribute(start: CellCoordinates) {\n    // if (this.rows * this.columns - this.mines < this.mines) {\n    //   this.distributeEmptyCells(start);\n    // } else {\n    this.distributeMines(start);\n    // }\n  }\n\n  private distributeEmptyCells(start: CellCoordinates) {\n    // TODO: implement bombs distribution when the number of bombs\n    //       is higher than the number of empty cells\n    throw new Error(\"Not implemented\");\n  }\n\n  private distributeMines([row, column]: CellCoordinates) {\n    let minesLeft = this.mines;\n    let mineRow: number;\n    let mineColumn: number;\n    while (minesLeft > 0) {\n      mineRow = Math.floor(Math.random() * this.maxRow);\n      mineColumn = Math.floor(Math.random() * this.maxCol);\n      if (\n        (mineRow === row && mineColumn === column) ||\n        (this.board[mineRow] !== undefined &&\n          this.board[mineRow][mineColumn] === MINE)\n      ) {\n        continue;\n      }\n      if (this.board[mineRow] === undefined) {\n        this.board[mineRow] = [];\n      }\n      if (this.board[mineRow][mineColumn] < MINE) {\n        this.nearbyHidden--;\n      }\n      this.board[mineRow][mineColumn] = MINE;\n      this.initNearbyCells([mineRow, mineColumn]);\n      minesLeft--;\n    }\n  }\n\n  private initNearbyCells([row, column]: CellCoordinates) {\n    for (let i = row - 1; i < row + 2; i++) {\n      for (let j = column - 1; j < column + 2; j++) {\n        if (\n          (i === row && j === column) ||\n          i < 0 ||\n          j < 0 ||\n          i > this.maxRow ||\n          j > this.maxCol\n        ) {\n          continue;\n        }\n        if (this.board[i] === undefined) {\n          this.board[i] = [];\n        }\n        switch (this.board[i][j]) {\n          case MINE:\n            break;\n          case undefined:\n            this.board[i][j] = -2;\n            this.nearbyHidden++;\n            break;\n\n          default:\n            this.board[i][j] -= 1;\n            break;\n        }\n      }\n    }\n  }\n}\n\nexport default Minesweeper;\n","import { createContext, Dispatch } from \"react\";\nimport Minesweeper, {\n  GameParameters,\n  CellCoordinates,\n} from \"../lib/Minesweeper\";\n\nexport interface State {\n  params: GameParameters;\n  minesweeper: Minesweeper;\n}\n\nexport enum ActionType {\n  SetParams = \"SET_PARAMS\",\n  Check = \"CHECK\",\n}\n\ninterface GenericAction<TType, TPayload> {\n  payload: TPayload;\n  type: TType;\n}\n\ntype Action =\n  | GenericAction<ActionType.SetParams, GameParameters>\n  | GenericAction<ActionType.Check, CellCoordinates>;\n\nconst GameContext = createContext<{\n  state: State;\n  dispatch: Dispatch<Action>;\n}>({ state: {} as State, dispatch: () => null });\n\nexport function reducer(state: State, { type, payload }: Action): State {\n  switch (type) {\n    case ActionType.SetParams:\n      return {\n        ...state,\n        params: payload as GameParameters,\n        minesweeper: new Minesweeper(payload as GameParameters),\n      };\n\n    case ActionType.Check:\n      state.minesweeper.check(payload as CellCoordinates);\n      return {\n        ...state,\n      };\n\n    default:\n      return state;\n  }\n}\n\nexport default GameContext;\n","import { CSSProperties, HTMLProps, useContext } from \"react\";\nimport { GridChildComponentProps } from \"react-window\";\nimport { MINE, OPENED, GameState } from \"../lib/Minesweeper\";\nimport GameContext from \"./GameContext\";\n\nexport const CELL_SIZE = 50;\nconst CELL_STYLE: CSSProperties = { width: CELL_SIZE, height: CELL_SIZE };\n\ninterface Props\n  extends GridChildComponentProps,\n    Pick<HTMLProps<HTMLButtonElement>, \"onClick\" | \"onContextMenu\"> {\n  flag?: boolean;\n}\n\nfunction Cell({\n  rowIndex,\n  columnIndex,\n  style,\n  onClick,\n  onContextMenu,\n  flag = false,\n}: Props) {\n  const {\n    state: { minesweeper },\n  } = useContext(GameContext);\n\n  let val: undefined | number =\n    minesweeper.board[rowIndex] && minesweeper.board[rowIndex][columnIndex];\n  let body: undefined | string | number = val;\n\n  if (\n    minesweeper.state === GameState.Lost ||\n    minesweeper.state === GameState.Won\n  ) {\n    switch (val) {\n      case MINE:\n        body = \"ðŸ’£\";\n        break;\n      case OPENED:\n      case undefined:\n        body = undefined;\n        break;\n\n      default:\n        if (val < MINE) {\n          body = val * -1 - 1;\n        }\n        break;\n    }\n  } else if (flag && (val < OPENED || val === undefined)) {\n    body = \"ðŸš©\";\n  } else if (val <= MINE) {\n    body = undefined;\n  } else if (val === OPENED) {\n    body = undefined;\n  } else if (val > OPENED) {\n  }\n\n  return (\n    <div className=\"cell\" style={style}>\n      <button\n        data-row={rowIndex}\n        data-column={columnIndex}\n        style={CELL_STYLE}\n        className=\"button\"\n        onClick={onClick}\n        onContextMenu={onContextMenu}\n        disabled={\n          val === OPENED ||\n          val > 0 ||\n          minesweeper.state === GameState.Lost ||\n          minesweeper.state === GameState.Won\n        }\n      >\n        {body}\n      </button>\n    </div>\n  );\n}\n\nexport default Cell;\n","import { MouseEventHandler, useContext, useEffect, useState } from \"react\";\nimport { FixedSizeGrid } from \"react-window\";\nimport useResizeObserver from \"use-resize-observer\";\nimport GameContext, { ActionType } from \"./GameContext\";\nimport Cell, { CELL_SIZE } from \"./Cell\";\nimport { CellCoordinates } from \"../lib/Minesweeper\";\n\nfunction getCoordinates(target: any): CellCoordinates {\n  return [\n    parseInt(target.dataset[\"row\"], 10),\n    parseInt(target.dataset[\"column\"], 10),\n  ];\n}\n\ninterface Flags {\n  [row: number]: { [column: number]: boolean };\n}\n\nlet numberOfFlags = 0;\n\nfunction Board() {\n  const { ref, width, height } = useResizeObserver<HTMLDivElement>();\n  const [flags, setFlags] = useState<Flags>({});\n  const {\n    state: { params, minesweeper },\n    dispatch,\n  } = useContext(GameContext);\n  useEffect(() => {\n    setFlags({});\n    numberOfFlags = 0;\n  }, [minesweeper]);\n  const handleClick: MouseEventHandler<HTMLButtonElement> = (e) => {\n    const target: any = e.target;\n    const [row, column] = getCoordinates(target);\n    if (flags[row] && flags[row][column]) {\n      return;\n    }\n    dispatch({\n      type: ActionType.Check,\n      payload: [row, column],\n    });\n  };\n\n  const handleContextMenu: MouseEventHandler<HTMLButtonElement> = (e) => {\n    if (e.type === \"contextmenu\") {\n      e.preventDefault();\n      if (numberOfFlags === params.mines) {\n        return;\n      }\n      const newFlags = {\n        ...flags,\n      };\n      const [row, column] = getCoordinates(e.target);\n      if (!newFlags[row]) {\n        newFlags[row] = {};\n      }\n      newFlags[row][column] = !newFlags[row][column];\n      setFlags(newFlags);\n      numberOfFlags++;\n    }\n  };\n\n  return (\n    <div\n      ref={ref}\n      className=\"container\"\n      style={{ minHeight: 300, height: \"100%\" }}\n    >\n      {width && height && (\n        <FixedSizeGrid\n          columnCount={params.columns}\n          rowCount={params.rows}\n          columnWidth={CELL_SIZE}\n          rowHeight={CELL_SIZE}\n          width={width}\n          height={height}\n        >\n          {(props) => (\n            <Cell\n              {...props}\n              flag={\n                flags[props.rowIndex] &&\n                flags[props.rowIndex][props.columnIndex]\n              }\n              onClick={handleClick}\n              onContextMenu={handleContextMenu}\n            />\n          )}\n        </FixedSizeGrid>\n      )}\n    </div>\n  );\n}\n\nexport default Board;\n","function parsePositiveNumber(input: string) {\n  const result = parseInt(input, 10);\n  if (!result || result < 0) {\n    return 0;\n  }\n  return result;\n}\n\nexport default parsePositiveNumber;\n","import React, { FormEvent, useContext, useState } from \"react\";\nimport { GameParameters, GameState } from \"../lib/Minesweeper\";\nimport parsePositiveNumber from \"../utils/parsePositiveNumber\";\nimport GameContext, { ActionType } from \"./GameContext\";\n\nfunction GameSetup() {\n  const { state, dispatch } = useContext(GameContext);\n  const [formData, setFormData] = useState<GameParameters>(state.params);\n  const handleChange = ({\n    target: { id, value },\n  }: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({ ...formData, [id]: parsePositiveNumber(value) });\n  };\n\n  const formIsValid = Object.values(formData).every((value: number) => value);\n\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (formIsValid) {\n      dispatch({ type: ActionType.SetParams, payload: formData });\n    }\n  };\n\n  let startButtonBody;\n  switch (state.minesweeper.state) {\n    case GameState.Lost:\n      startButtonBody = \"ðŸ˜µ\";\n      break;\n\n    case GameState.Won:\n      startButtonBody = \"ðŸ˜Ž\";\n      break;\n\n    default:\n      startButtonBody = \"ðŸ˜€\";\n      break;\n  }\n\n  return (\n    <form className=\"container pb-3\" onSubmit={handleSubmit}>\n      <div className=\"columns\">\n        <div className=\"column\">\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"rows\">\n              Rows\n            </label>\n            <div className=\"control\">\n              <input\n                id=\"rows\"\n                name=\"rows\"\n                type=\"number\"\n                className=\"input\"\n                autoComplete=\"off\"\n                value={formData?.rows.toString()}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"column\">\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"columns\">\n              Columns\n            </label>\n            <div className=\"control\">\n              <input\n                id=\"columns\"\n                name=\"columns\"\n                className=\"input\"\n                autoComplete=\"off\"\n                type=\"number\"\n                value={formData?.columns.toString()}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"column\">\n          <div className=\"field\">\n            <label className=\"label\" htmlFor=\"mines\">\n              Mines\n            </label>\n            <div className=\"control\">\n              <input\n                id=\"mines\"\n                name=\"mines\"\n                className=\"input\"\n                autoComplete=\"off\"\n                type=\"number\"\n                value={formData?.mines.toString()}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"has-text-centered\">\n        <button\n          className=\"button is-primary is-large\"\n          disabled={!formIsValid}\n          type=\"submit\"\n        >\n          {startButtonBody}\n        </button>\n      </div>\n    </form>\n  );\n}\n\nexport default GameSetup;\n","import React, { useReducer } from \"react\";\nimport Board from \"./Board\";\nimport GameContext, { reducer, State } from \"./GameContext\";\nimport GameSetup from \"./GameSetup\";\nimport \"./Game.css\";\nimport Minesweeper, { GameParameters } from \"../lib/Minesweeper\";\n\nconst initialParams: GameParameters = {\n  rows: 1000,\n  columns: 1000,\n  mines: 20000,\n};\nconst initialState: State = {\n  params: initialParams,\n  minesweeper: new Minesweeper(initialParams),\n};\n\nfunction Game() {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  return (\n    <GameContext.Provider value={{ state, dispatch }}>\n      <div className=\"is-flex is-flex-direction-column game\">\n        <section className=\"hero\">\n          <div className=\"hero-body\">\n            <div className=\"container\">\n              <h1 className=\"title\">Minesweeper Game</h1>\n              <h2 className=\"subtitle\">\n                <a href=\"https://github.com/dn-l/react-minesweeper\">\n                  github.com/dn-l/react-minesweeper\n                </a>\n              </h2>\n            </div>\n          </div>\n        </section>\n        <section>\n          <GameSetup />\n        </section>\n        <section className=\"pb-5\" style={{ flex: 1 }}>\n          <Board />\n        </section>\n      </div>\n    </GameContext.Provider>\n  );\n}\n\nexport default Game;\n","import React from \"react\";\nimport Game from \"./components/Game\";\n\nfunction App() {\n  return <Game />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}